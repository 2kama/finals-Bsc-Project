<!DOCTYPE html>
<!--[if IE 8]>			<html class="ie ie8"> <![endif]-->
<!--[if IE 9]>			<html class="ie ie9"> <![endif]-->
<!--[if gt IE 9]><!-->	<html> <!--<![endif]-->
	<head>
		<meta charset="utf-8" />
		<title>FRSC vtr</title>
		<meta name="keywords" content="HTML5,CSS3,Template" />
		<meta name="description" content="" />
		<meta name="Author" content="Dorin Grigoras [www.stepofweb.com]" />

		<!-- mobile settings -->
		<meta name="viewport" content="width=device-width, maximum-scale=1, initial-scale=1, user-scalable=0" />
		<!--[if IE]><meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'><![endif]-->

		<!-- WEB FONTS : use %7C instead of | (pipe) -->
		<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400%7CRaleway:300,400,500,600,700%7CLato:300,400,400italic,600,700" rel="stylesheet" type="text/css" />

		<!-- CORE CSS -->
		<link href="assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />

		<script type="text/javascript" src="assets/plugins/jquery/jquery-2.1.4.min.js"></script>

		<!-- THEME CSS -->
		<link href="assets/css/essentials.css" rel="stylesheet" type="text/css" />
		<link href="assets/css/layout.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="js/moment.js"></script>

		<!-- PAGE LEVEL SCRIPTS -->
		<link href="assets/css/header-1.css" rel="stylesheet" type="text/css" />
		<link href="assets/css/color_scheme/green.css" rel="stylesheet" type="text/css" id="color_scheme" />

      <script type="text/javascript" src="js/w3.js"></script>
	</head>


	<body class="smoothscroll enable-animation">




		<!-- wrapper -->
		<div id="wrapper">


			<div id="header" class="sticky clearfix header-sm">

				<!-- TOP NAV -->
				<header id="topNav">
					<div class="container">

						<!-- Mobile Menu Button -->
						<button class="btn btn-mobile" data-toggle="collapse" data-target=".nav-main-collapse">
							<i class="fa fa-bars"></i>
						</button>


						<!-- Logo -->
						<a class="logo pull-left" href="index.html">
							<img src="assets/images/.png" alt="" />
						</a>


						<div class="navbar-collapse pull-right nav-main-collapse collapse">
							<nav class="nav-main">


								<ul id="topMain" class="nav nav-pills nav-main">
									<li>
										<a  href="home.html">
											HOME
										</a>

									</li>

                  <li><a href="report.html">REPORTS</a></li>

                  <li><a href="javascript:;" class="lo">LOGOUT</a></li>
								</ul>

							</nav>
						</div>

					</div>
				</header>
				<!-- /Top Nav -->

			</div>


			<!-- -->


      <section>
        <div class="container">

          


          <div class="col-md-12">

          <div class="alert alert-mini alert-danger margin-bottom-30" style="display:none;">
                <strong>Oh snap!</strong> Login Incorrect!
              </div><!-- /ALERT -->



            <form class="nomargin" method="post" action="#" autocomplete="off">
              <div class="clearfix">

                <!-- Email -->
                <div class="form-group">
                  <input type="text" name="text" class="form-control getCar" placeholder="Search">
                </div>

              </div>

              <div class="row">



              </div>

            </form>

          </div>


     


						  <div class="col-md-12">


                  <div class="col-md-2"></div>

                  <div class="col-md-8">
                    


                      <h3>Car Details</h3>

                      <div class="col-md-6">
                          
                          <div class="fancy-form">
                            <i class="fa fa-user"></i>

                            <input type="text" class="form-control carOwner" placeholder="Car Owner" disabled />

                          </div>

                      </div>

                      <div class="col-md-6">
                          
                          <div class="fancy-form">
                            <i class="fa fa-user"></i>

                            <input type="text" class="form-control ownerNumber" placeholder="Owner Phone Number" disabled />

                          </div>

                      </div>


                      <div class="col-md-6">
                          
                          <div class="fancy-form">
                            <i class="fa fa-user"></i>

                            <input type="text" class="form-control carPlate" placeholder="Car Plate No" disabled />

                          </div>

                      </div>

                      <div class="col-md-6">
                          
                          <div class="fancy-form">
                            <i class="fa fa-user"></i>

                            <input type="text" class="form-control carVin" placeholder="Car VI No" disabled />

                          </div>

                      </div>



                      <div class="col-md-6">
                          
                          <div class="fancy-form">
                            <i class="fa fa-user"></i>

                            <input type="text" class="form-control carBrand" placeholder="Car Brand" disabled />

                          </div>

                      </div>

                      <div class="col-md-6">
                          
                          <div class="fancy-form">
                            <i class="fa fa-user"></i>

                            <input type="text" class="form-control carModel" placeholder="Car Model" disabled />

                          </div>

                      </div>


                      <div class="col-md-6">
                          
                          <div class="fancy-form">
                            <i class="fa fa-user"></i>

                            <input type="text" class="form-control carColor" placeholder="Car Color" disabled />

                          </div>

                      </div>

                      <div class="col-md-6">
                          <div class="fancy-form">
                            <i class="fa fa-user"></i>

                            <input type="text" class="form-control engineNo" placeholder="Engine Number" disabled />

                          </div>

                        
                      </div>




                      <h3>Report Details</h3>

                      <div class="col-md-6">
                          
                          <div class="fancy-form">
                            <i class="fa fa-user"></i>

                            <input type="text" class="form-control reporterName" placeholder="Name of Reporter" />

                          </div>

                      </div>


                      <div class="col-md-6">
                          
                          <div class="fancy-form">
                            <i class="fa fa-user"></i>

                            <input type="tel" class="form-control reporterNumber" placeholder="Phone Number of Reporter" />

                          </div>

                      </div>


                      <div class="col-md-6">
                          
                          <div class="fancy-form">
                            <i class="fa fa-user"></i>

                            <input type="text" class="form-control reporterAddress" placeholder="Address of Reporter" />

                          </div>

                      </div>


                      <div class="col-md-6">
                          
                          <div class="fancy-form">
                            <i class="fa fa-user"></i>

                            <input type="text" class="form-control newCarColor" placeholder="New Car Color" />

                          </div>

                      </div>



                      <div class="col-md-12">
                          
                          <div class="fancy-form">
                            <textarea rows="5" class="form-control word-count statement" data-maxlength="200" data-info="textarea-words-info" placeholder="Statement"></textarea>

                            <i class="fa fa-comments"><!-- icon --></i>

                          

                          </div>

                      </div>


                      <div class="col-md-6 col-sm-6 col-xs-6 text-right">

                            <button class="btn btn-primary complain">SUBMIT</button>

                    </div>







                  </div>

                  <div class="col-md-2"></div>


						  </div>

				</div>

			</section>
			<!-- / -->

      <section></section>




			<!-- FOOTER -->
			<footer id="footer">

				<div class="copyright">
					<div class="container">
						<ul class="pull-right nomargin list-inline mobile-block">
							<li><a href="#">Terms &amp; Conditions</a></li>
							<li>&bull;</li>
							<li><a href="#">Privacy</a></li>
						</ul>
						&copy; All Rights Reserved, Company LTD
					</div>
				</div>
			</footer>
			<!-- /FOOTER -->

		</div>
		<!-- /wrapper -->


		<!-- SCROLL TO TOP -->
		<a href="#" id="toTop"></a>




		<!-- JAVASCRIPT FILES -->
		<script type="text/javascript">let plugin_path = 'assets/plugins/';</script>

		<script type="text/javascript" src="assets/js/scripts.js"></script>

   
		<script src="https://www.gstatic.com/firebasejs/6.2.2/firebase-app.js"></script>

    <script src="https://www.gstatic.com/firebasejs/6.2.2/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/6.2.2/firebase-firestore.js"></script>
  
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDbfGDVHLQhmwJlYVOvYdfZekA9kGWgrsU",
      authDomain: "vtrsystem.firebaseapp.com",
      databaseURL: "https://vtrsystem.firebaseio.com",
      projectId: "vtrsystem",
      storageBucket: "vtrsystem.appspot.com",
      messagingSenderId: "833944980186",
      appId: "1:833944980186:web:f7cdc1cbd247be7a"
    };

    firebase.initializeApp(firebaseConfig);
  </script>
  



    <script type="text/javascript">
        $(document).ready(function() {


        const auth = firebase.auth();
    const db = firebase.firestore();


    auth.onAuthStateChanged(user => {
      if (user) {

        let uid = auth.currentUser.uid;



            $('.lo').click(function() {
                auth.signOut();

            });







              $('.nomargin').submit(e => {

               e.preventDefault();

               let getCar = $('.getCar').val();



                  db.collection("car").where("CarPlate", "==", getCar).get().then(querySnapShot => {


                      if(querySnapShot.size == 1) {

                          querySnapShot.forEach(doc => {

                            $('.carOwner').val(doc.data().OwnerName);
                              $('.ownerNumber').val(doc.data().OwnerNumber);
                              $('.carColor').val(doc.data().CarColor);
                              $('.carBrand').val(doc.data().CarBrand);
                              $('.carModel').val(doc.data().CarModel);
                              $('.carPlate').val(doc.data().CarPlate);
                              $('.carVin').val(doc.data().CarVin);
                              $('.newCarColor').val(doc.data().CarColor);
                              $('.engineNo').val(doc.data().EngineNumber);


                              let verifyCode = Math.random().toString(26).substr(2, 8);
                              let dateTime = new Date().getTime();
                              let timestamp = Math.floor(dateTime / 1000);


                              db.collection("checked").doc(`${uid}_${verifyCode}`).set({

                                 check: doc.id,
                                 time: timestamp,
                                 who: uid

                              });

                          })


                              


                      }else {


                      


                        db.collection("car").where("CarVin", "==", getCar).get().then(querySnapShot2 => {

                              if(querySnapShot2.size == 1) {


                                querySnapShot2.forEach(docs => {

                                  $('.carOwner').val(docs.data().OwnerName);
                                  $('.ownerNumber').val(docs.data().OwnerNumber);
                                  $('.carColor').val(docs.data().CarColor);
                                  $('.carBrand').val(docs.data().CarBrand);
                                  $('.carModel').val(docs.data().CarModel);
                                  $('.carPlate').val(docs.data().CarPlate);
                                  $('.carVin').val(docs.data().CarVin);
                                  $('.newCarColor').val(docs.data().CarColor);
                                  $('.engineNo').val(docs.data().EngineNumber);



                                  let verifyCode = Math.random().toString(26).substr(2, 8);
                                  let dateTime = new Date().getTime();
                                  let timestamp = Math.floor(dateTime / 1000);


                                  db.collection("checked").doc(`${uid}_${verifyCode}`).set({

                                    check: docs.id,
                                    time: timestamp,
                                    who: uid

                                  });
                                })

                               


                              }else {


                                $('.alert').html("No Registration data found").show();

                                setTimeout(function() {
                                    $('.alert').hide();

                                }, 3000);



                              }

                        }).catch(error => {


                              $('.alert').html(error.message).show();

                                setTimeout(function() {
                                    $('.alert').hide();

                                }, 3000);


                              })


                      }

                  }).catch(error => {


                    $('.alert').html(error.message).show();

                      setTimeout(function() {
                          $('.alert').hide();

                      }, 3000);


                  })



              });



              




             $('.complain').click(function() {

                  let carOwner = $('.carOwner').val();

                  if(carOwner != "") {

                        let complainer = $('.reporterName').val();
                        let complainerAddr = $('.reporterAddress').val();
                        let complainerNum = $('.reporterNumber').val();
                        let newColor = $('.newCarColor').val();
                        let statement = $('.statement').val();

                        let carOwner = $('.carOwner').val();
                      let ownerNumber = $('.ownerNumber').val();
                       let carColor = $('.carColor').val();
                       let carBrand = $('.carBrand').val();
                       let carModel = $('.carModel').val();
                       let carPlate = $('.carPlate').val();
                        let carVin = $('.carVin').val();


                        let verifyCode = Math.random().toString(26).substr(2, 8);

                         let dateTime = new Date().getTime();
                            let timestamp = Math.floor(dateTime / 1000);

                            db.collection("report").doc(`complaintCode_${verifyCode}`).set({

                                       carOwner: carOwner,
                                       ownerNumber: ownerNumber,
                                       carColor: carColor,
                                       carBrand: carBrand,
                                       carModel: carModel,
                                       carVin: carVin,
                                       carPlate: carPlate,
                                       report: "missing",
                                       timestamp: timestamp,
                                       complainer: complainer,
                                          complainerAddr: complainerAddr,
                                          complainerNum: complainerNum,
                                          newColor: newColor,
                                          statement: statement,
                                          reportID: verifyCode

                                  }).then(() => {


                                             $('.reporterName').val("");
                                              $('.reporterAddress').val("");
                                              $('.reporterNumber').val("");
                                              $('.newCarColor').val("");
                                              $('.statement').val("");

                                              $('.carOwner').val("");
                                             $('.ownerNumber').val("");
                                             $('.carColor').val("");
                                             $('.carBrand').val("");
                                             $('.carModel').val("");
                                             $('.carPlate').val("");
                                             $('.carVin').val("");


                                            alert("data added")




                                  });




                  }
                  
                  else {
                     $('.alert').html("No data to send complaint").show();

                     setTimeout(() => {
                        $('.alert').hide();
                     }, 3000);
                  }

             });




      } else {


          setTimeout("location.href = 'index.html';",0000);
          
      }

  });

        });
    </script>

	</body>
</html>
